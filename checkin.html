<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="dicoding:email" content="bagusasp01@gmail.com">
    <title>MentyMate - Kesehatan Mental</title>
    <link rel="icon" href="assets/icon.png" type="image/png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="assets/styles.css">
</head>
<body>

    <div id="loadingOverlay" class="loading-overlay d-none">
        <div class="spinner-border" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>

    <nav class="navbar navbar-expand-lg navbar-dark bg-primary-custom sticky-top">
        <div class="container">
          <a class="navbar-brand" href="index.html">MentyMate</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
              <li class="nav-item">
                <a class="nav-link" href="index.html">Beranda</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="index.html#fitur">Fitur</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="index.html#manfaat">Manfaat</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#chatbotModal">Chatbot</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="blog.html">Blog</a>
              </li>
              <li class="nav-item">
                <a class="nav-link active" href="checkin.html">Checkin</a>
              </li>
              <li class="nav-item d-none" id="logoutNavButtonContainer"> <button id="logoutButton" class="btn btn-outline-light ms-lg-2 mt-2 mt-lg-0">Logout</button>
              </li>
            </ul>
          </div>
        </div>
    </nav>

    <main class="container-fluid mt-4 p-3 p-md-4">
        <div id="messageArea" class="mb-4"></div>

        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-5">
                <section id="authSection" class="auth-card p-4 p-md-5">
                    <div id="loginView">
                        <h2 class="fs-2 fw-bold mb-4 text-center text-primary-custom">Login</h2>
                        <form id="loginForm">
                            <div class="mb-3">
                                <label for="loginUsername" class="form-label small fw-medium mb-1" style="color: var(--dark-text);">Username</label>
                                <input type="text" id="loginUsername" name="username" required class="form-control themed-input">
                            </div>
                            <div class="mb-4">
                                <label for="loginPassword" class="form-label small fw-medium mb-1" style="color: var(--dark-text);">Password</label>
                                <input type="password" id="loginPassword" name="password" required class="form-control themed-input">
                            </div>
                            <button type="submit" class="w-100 btn btn-primary-custom fw-semibold py-2 rounded">Login</button>
                        </form>
                        <p class="mt-4 text-center small">
                            Belum punya akun? <button id="showRegisterButton" class="btn btn-link text-secondary-custom p-0 align-baseline fw-medium">Daftar di sini</button>
                        </p>
                    </div>

                    <div id="registerView" class="d-none">
                        <h2 class="fs-2 fw-bold mb-4 text-center text-primary-custom">Register</h2>
                        <form id="registerForm">
                            <div class="mb-3">
                                <label for="registerUsername" class="form-label small fw-medium mb-1" style="color: var(--dark-text);">Username</label>
                                <input type="text" id="registerUsername" name="username" required class="form-control themed-input">
                            </div>
                             <div class="mb-3">
                                <label for="registerPhone" class="form-label small fw-medium mb-1" style="color: var(--dark-text);">Nomor Telepon</label>
                                <input type="number" id="registerPhone" name="phone" required class="form-control themed-input">
                            </div>
                            <div class="mb-4">
                                <label for="registerPassword" class="form-label small fw-medium mb-1" style="color: var(--dark-text);">Password</label>
                                <input type="password" id="registerPassword" name="password" required class="form-control themed-input">
                            </div>
                            <button type="submit" class="w-100 btn btn-secondary-custom fw-semibold py-2 rounded">Register</button>
                        </form>
                        <p class="mt-4 text-center small">
                            Sudah punya akun? <button id="showLoginButton" class="btn btn-link text-secondary-custom p-0 align-baseline fw-medium">Login di sini</button>
                        </p>
                    </div>
                </section>
            </div>
        </div>

        <div class="row justify-content-center mt-4">
            <div class="col-md-10 col-lg-8">
                <section id="appContentSection" class="d-none app-content-card p-4 p-md-5">
                    <h2 class="fs-2 fw-bold mb-2 text-center text-primary-custom">Daily Check-in</h2>
                    <p id="welcomeMessage" class="text-center mb-3" style="color: var(--dark-text);"></p>

                    <div class="feature-description text-center mb-4">
                         <p class="mb-1">Selamat datang di halaman Daily Check-in! Di sini Anda dapat:</p>
                         <ul class="list-unstyled mb-0">
                             <li>📝 Mencatat perasaan dan kondisi mental Anda setiap hari.</li>
                             <li>💡 Mendapatkan rekomendasi aktivitas positif yang disesuaikan.</li>
                             <li>📊 Melihat riwayat check-in Anda untuk memantau perkembangan.</li>
                             <li>💬 Mengobrol dengan teman-teman di grup dukungan Anda.</li>
                             <li>👤 Mengubah profil Anda.</li>
                         </ul>
                    </div>

                    <div class="text-center mb-4 d-flex flex-wrap justify-content-center gap-2">
                        <button id="showCheckinViewButton" class="btn btn-primary-custom btn-sm"><i class="fas fa-home me-1"></i> Beranda Checkin</button>
                        <button id="showGroupViewButton" class="btn btn-outline-primary-custom btn-sm"><i class="fas fa-users me-1"></i> Grup & Chat</button>
                        <button id="showEditProfileButton" class="btn btn-outline-primary-custom btn-sm"><i class="fas fa-user-edit me-1"></i> Edit Profil</button>
                    </div>

                    <!-- VIEW: Check-in Utama -->
                    <div id="checkInMainView">
                        <div id="checkInFormView">
                            <form id="checkInForm" class="mb-4">
                                <div class="mb-3">
                                    <label for="mood" class="form-label small fw-medium mb-1" style="color: var(--dark-text);">Bagaimana perasaanmu hari ini?</label>
                                    <select id="mood" name="mood" required class="form-select themed-select">
                                        <option value="baik">Baik 😊</option>
                                        <option value="sedang">Sedang 😐</option>
                                        <option value="buruk">Buruk 😟</option>
                                    </select>
                                </div>
                                <div class="mb-4">
                                    <label for="description" class="form-label small fw-medium mb-1" style="color: var(--dark-text);">Ceritakan lebih lanjut (opsional):</label>
                                    <textarea id="description" name="description" rows="3" class="form-control themed-textarea"></textarea>
                                </div>
                                <button type="submit" class="btn btn-success-custom fw-semibold py-2 rounded btn-checkin-submit">Kirim Check-in</button>
                            </form>
                        </div>
                        <div class="d-grid gap-3 d-sm-flex justify-content-sm-center mb-5">
                            <button id="getRecommendationButton" class="btn btn-primary-custom fw-semibold py-2 rounded flex-sm-fill">Dapatkan Rekomendasi</button>
                            <button id="getHistoryButton" class="btn btn-secondary-custom fw-semibold py-2 rounded flex-sm-fill">Riwayat Check-in</button>
                        </div>
                    </div>

                    <!-- VIEW: Edit Profil -->
                    <div id="editProfileView" class="d-none">
                        <h3 class="fs-5 fw-semibold mb-3 text-primary-custom">Edit Profil</h3>
                        <form id="editProfileForm">
                            <div class="mb-3">
                                <label for="editUsername" class="form-label small fw-medium">Username Baru</label>
                                <input type="text" id="editUsername" class="form-control themed-input">
                            </div>
                             <div class="mb-3">
                                <label for="editPhone" class="form-label small fw-medium">Nomor Telepon Baru</label>
                                <input type="number" id="editPhone" class="form-control themed-input">
                                <div class="form-text small">Diawali dengan 62, contoh 628123456789.</div>
                            </div>
                            <div class="mb-3">
                                <label for="editPassword" class="form-label small fw-medium">Password Baru</label>
                                <input type="password" id="editPassword" class="form-control themed-input" placeholder="Kosongkan jika tidak ingin diubah">
                                <div class="form-text small">Password baru harus berbeda dari password saat ini.</div>
                            </div>
                            <div class="d-flex justify-content-end gap-2">
                                <button type="button" id="cancelEditProfileButton" class="btn btn-outline-secondary btn-sm">Batal</button>
                                <button type="submit" class="btn btn-primary-custom btn-sm">Simpan Perubahan</button>
                            </div>
                        </form>
                    </div>

                    <!-- VIEW: Grup (Manajemen & List) -->
                    <div id="groupView" class="d-none">
                        <h3 class="fs-5 fw-semibold mb-3 text-primary-custom">Grup Saya</h3>
                        <p class="small text-muted mb-3">Klik pada sebuah grup untuk memulai obrolan. Gunakan menu titik tiga untuk opsi lainnya.</p>
                        <div id="groupList" class="mb-4"></div>

                        <div id="createGroupView" class="mb-4">
                             <h4 class="fs-6 fw-semibold mb-3 text-primary-custom">Buat Grup Baru</h4>
                             <form id="createGroupForm">
                                 <div class="input-group">
                                     <input type="text" id="groupName" class="form-control themed-input" placeholder="Nama Grup Baru" required>
                                     <button type="submit" class="btn btn-success-custom">Buat</button>
                                 </div>
                             </form>
                         </div>
                    </div>
                    
                    <!-- VIEW: Chat Grup -->
                    <div id="groupChatView" class="d-none">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h3 class="fs-5 fw-semibold text-primary-custom mb-0" id="groupChatTitle"></h3>
                            <button id="backToGroupsButton" class="btn btn-outline-secondary btn-sm">
                                <i class="fas fa-arrow-left me-1"></i> Kembali ke Grup
                            </button>
                        </div>
                        <div id="chatMessagesContainer" class="chat-messages-container mb-3">
                            <!-- Pesan akan ditambahkan di sini oleh JavaScript -->
                        </div>
                        <form id="groupChatForm">
                            <input type="hidden" id="chatGroupId">
                            <div class="input-group">
                                <input type="text" id="chatMessageInput" class="form-control themed-input" placeholder="Ketik pesan..." required autocomplete="off">
                                <button class="btn btn-primary-custom" type="submit"><i class="fas fa-paper-plane"></i></button>
                            </div>
                        </form>
                    </div>

                    <!-- VIEW: Rekomendasi -->
                    <div id="recommendationView" class="d-none mt-4 recommendation-view">
                        <h3 class="fs-5 fw-semibold mb-3 text-primary-custom">Rekomendasi Aktivitas</h3>
                        <div id="recommendationText" style="color: var(--dark-text);"></div>
                    </div>

                    <!-- VIEW: Riwayat -->
                    <div id="historyView" class="d-none mt-4">
                        <h3 class="fs-5 fw-semibold mb-3 text-primary-custom">Riwayat Check-in Anda</h3>
                        <div id="historyList" class="d-grid gap-3"></div>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                <h3 class="mb-3">MentyMate</h3>
                <p>Teman virtual untuk kesehatan mental yang lebih baik.</p>
                </div>
                <div class="col-md-6 text-center text-md-end">
                <p>© 2025 MentyMate. Hak Cipta Dilindungi.</p>
                <p>Dibuat dengan <i class="fas fa-heart text-accent-custom"></i> untuk kesehatan mental yang lebih baik.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- MODAL UTAMA -->
    <div id="customModal" class="custom-modal d-none">
        <div class="custom-modal-content">
            <h3 id="modalTitle" class="fs-5 fw-bold mb-3">Pemberitahuan</h3>
            <div id="modalMessage" class="mb-4" style="color: var(--dark-text);"></div>
            <div id="modalActionButtons" class="d-flex gap-2">
                 <button class="w-100 btn btn-primary-custom fw-semibold py-2 rounded modal-close-button">Tutup</button>
            </div>
        </div>
    </div>

    <!-- MODAL KHUSUS EDIT GRUP -->
    <div id="editGroupModal" class="modal fade" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Edit Nama Grup</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editGroupFormModal">
                        <input type="hidden" id="editGroupIdInput">
                        <div class="mb-3">
                            <label for="editGroupNameInput" class="form-label">Nama Grup Baru</label>
                            <input type="text" class="form-control" id="editGroupNameInput" required>
                        </div>
                         <button type="submit" class="btn btn-primary-custom w-100">Simpan</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL KHUSUS KELOLA ANGGOTA -->
    <div id="manageMembersModal" class="modal fade" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="manageMembersModalTitle">Kelola Anggota</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addMemberFormInModal" class="mb-4">
                         <h6 class="fs-6">Tambah Anggota</h6>
                         <input type="hidden" id="addMemberModalGroupId">
                         <div class="input-group">
                             <input type="text" id="addMemberModalUsername" class="form-control themed-input" placeholder="Username Anggota" required>
                             <button type="submit" class="btn btn-success-custom">Tambah</button>
                         </div>
                    </form>
                    <h6 class="fs-6">Daftar Anggota</h6>
                    <ul id="memberList" class="list-group">
                        <!-- Daftar anggota akan diisi oleh JavaScript -->
                    </ul>
                </div>
            </div>
        </div>
    </div>


    <div class="modal fade" id="chatbotModal" tabindex="-1" aria-labelledby="chatbotModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header chat-header">
            <div class="chat-header-icon">
              <i class="fas fa-comment-dots"></i>
            </div>
            <div>
              <h5 class="modal-title" id="chatbotModalLabel">MentyMate Chatbot</h5>
              <small>Online</small>
            </div>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="chat-box" id="chat-box">
              <div class="chat-message ai-message">
                <strong>MentyMate:</strong> Halo! Saya MentyMate, asisten kesehatan mental virtualmu. Bagaimana perasaanmu hari ini? Ada yang bisa saya bantu?
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <div class="chat-input-container">
              <textarea class="chat-input" id="user-input" placeholder="Ketik pesanmu di sini..." rows="1"></textarea>
              <button class="btn btn-secondary-custom chat-send-btn" id="send-button">
                <i class="fas fa-paper-plane"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <script src="assets/scripts.js"></script>
</body>
</html>
